from numpy import uint64 as uint, array
from fen import *
import pickle

BITBOARDS,data,halfMoves = generate_bitboards_from_board(fenString)

WHITE_PAWNS = BITBOARDS[0]
WHITE_KNIGHTS = BITBOARDS[1]
WHITE_BISHOPS = BITBOARDS[2]
WHITE_ROOKS = BITBOARDS[3]
WHITE_QUEEN = BITBOARDS[4]
WHITE_KING = BITBOARDS[5]

BLACK_PAWNS = BITBOARDS[6]
BLACK_KNIGHTS = BITBOARDS[7]
BLACK_BISHOPS = BITBOARDS[8]
BLACK_ROOKS = BITBOARDS[9]
BLACK_QUEEN = BITBOARDS[10]
BLACK_KING = BITBOARDS[11]

WHITE_PAWN_PUSHES = array([
    uint(0),
    uint(0),
    uint(0),
    uint(0),
    uint(0),
    uint(0),
    uint(0),
    uint(0),
    uint(1),
    uint(2),
    uint(4),
    uint(8),
    uint(16),
    uint(32),
    uint(64),
    uint(128),
    uint(256),
    uint(512),
    uint(1024),
    uint(2048),
    uint(4096),
    uint(8192),
    uint(16384),
    uint(32768),
    uint(65536),
    uint(131072),
    uint(262144),
    uint(524288),
    uint(1048576),
    uint(2097152),
    uint(4194304),
    uint(8388608),
    uint(16777216),
    uint(33554432),
    uint(67108864),
    uint(134217728),
    uint(268435456),
    uint(536870912),
    uint(1073741824),
    uint(2147483648),
    uint(4294967296),
    uint(8589934592),
    uint(17179869184),
    uint(34359738368),
    uint(68719476736),
    uint(137438953472),
    uint(274877906944),
    uint(549755813888),
    uint(1103806595072),
    uint(2207613190144),
    uint(4415226380288),
    uint(8830452760576),
    uint(17660905521152),
    uint(35321811042304),
    uint(70643622084608),
    uint(141287244169216),
])

BLACK_PAWN_PUSHES = array([
    uint(0),
    uint(0),
    uint(0),
    uint(0),
    uint(0),
    uint(0),
    uint(0),
    uint(0),
    uint(16842752),
    uint(33685504),
    uint(67371008),
    uint(134742016),
    uint(269484032),
    uint(538968064),
    uint(1077936128),
    uint(2155872256),
    uint(16777216),
    uint(33554432),
    uint(67108864),
    uint(134217728),
    uint(268435456),
    uint(536870912),
    uint(1073741824),
    uint(2147483648),
    uint(4294967296),
    uint(8589934592),
    uint(17179869184),
    uint(34359738368),
    uint(68719476736),
    uint(137438953472),
    uint(274877906944),
    uint(549755813888),
    uint(1099511627776),
    uint(2199023255552),
    uint(4398046511104),
    uint(8796093022208),
    uint(17592186044416),
    uint(35184372088832),
    uint(70368744177664),
    uint(140737488355328),
    uint(281474976710656),
    uint(562949953421312),
    uint(1125899906842624),
    uint(2251799813685248),
    uint(4503599627370496),
    uint(9007199254740992),
    uint(18014398509481984),
    uint(36028797018963968),
    uint(72057594037927936),
    uint(144115188075855872),
    uint(288230376151711744),
    uint(576460752303423488),
    uint(1152921504606846976),
    uint(2305843009213693952),
    uint(4611686018427387904),
    uint(9223372036854775808),
    uint(0),
    uint(0),
    uint(0),
    uint(0),
    uint(0),
    uint(0),
    uint(0),
    uint(0),
])

WHITE_PAWN_ATTACKS = array([
    uint(0),
    uint(0),
    uint(0),
    uint(0),
    uint(0),
    uint(0),
    uint(0),
    uint(0),
    uint(2),
    uint(5),
    uint(10),
    uint(20),
    uint(40),
    uint(80),
    uint(160),
    uint(64),
    uint(512),
    uint(1280),
    uint(2560),
    uint(5120),
    uint(10240),
    uint(20480),
    uint(40960),
    uint(16384),
    uint(131072),
    uint(327680),
    uint(655360),
    uint(1310720),
    uint(2621440),
    uint(5242880),
    uint(10485760),
    uint(4194304),
    uint(33554432),
    uint(83886080),
    uint(167772160),
    uint(335544320),
    uint(671088640),
    uint(1342177280),
    uint(2684354560),
    uint(1073741824),
    uint(8589934592),
    uint(21474836480),
    uint(42949672960),
    uint(85899345920),
    uint(171798691840),
    uint(343597383680),
    uint(687194767360),
    uint(274877906944),
    uint(2199023255552),
    uint(5497558138880),
    uint(10995116277760),
    uint(21990232555520),
    uint(43980465111040),
    uint(87960930222080),
    uint(175921860444160),
    uint(70368744177664),
    uint(562949953421312),
    uint(1407374883553280),
    uint(2814749767106560),
    uint(5629499534213120),
    uint(11258999068426240),
    uint(22517998136852480),
    uint(45035996273704960),
    uint(18014398509481984),
])

BLACK_PAWN_ATTACKS = array([
    uint(512),
    uint(1280),
    uint(2560),
    uint(5120),
    uint(10240),
    uint(20480),
    uint(40960),
    uint(16384),
    uint(131072),
    uint(327680),
    uint(655360),
    uint(1310720),
    uint(2621440),
    uint(5242880),
    uint(10485760),
    uint(4194304),
    uint(33554432),
    uint(83886080),
    uint(167772160),
    uint(335544320),
    uint(671088640),
    uint(1342177280),
    uint(2684354560),
    uint(1073741824),
    uint(8589934592),
    uint(21474836480),
    uint(42949672960),
    uint(85899345920),
    uint(171798691840),
    uint(343597383680),
    uint(687194767360),
    uint(274877906944),
    uint(2199023255552),
    uint(5497558138880),
    uint(10995116277760),
    uint(21990232555520),
    uint(43980465111040),
    uint(87960930222080),
    uint(175921860444160),
    uint(70368744177664),
    uint(562949953421312),
    uint(1407374883553280),
    uint(2814749767106560),
    uint(5629499534213120),
    uint(11258999068426240),
    uint(22517998136852480),
    uint(45035996273704960),
    uint(18014398509481984),
    uint(144115188075855872),
    uint(360287970189639680),
    uint(720575940379279360),
    uint(1441151880758558720),
    uint(2882303761517117440),
    uint(5764607523034234880),
    uint(11529215046068469760),
    uint(4611686018427387904),
    uint(0),
    uint(0),
    uint(0),
    uint(0),
    uint(0),
    uint(0),
    uint(0),
    uint(0),
])

KING_ATTACKS = array([
    uint(770),
    uint(1797),
    uint(3594),
    uint(7188),
    uint(14376),
    uint(28752),
    uint(57504),
    uint(49216),
    uint(197123),
    uint(460039),
    uint(920078),
    uint(1840156),
    uint(3680312),
    uint(7360624),
    uint(14721248),
    uint(12599488),
    uint(50463488),
    uint(117769984),
    uint(235539968),
    uint(471079936),
    uint(942159872),
    uint(1884319744),
    uint(3768639488),
    uint(3225468928),
    uint(12918652928),
    uint(30149115904),
    uint(60298231808),
    uint(120596463616),
    uint(241192927232),
    uint(482385854464),
    uint(964771708928),
    uint(825720045568),
    uint(3307175149568),
    uint(7718173671424),
    uint(15436347342848),
    uint(30872694685696),
    uint(61745389371392),
    uint(123490778742784),
    uint(246981557485568),
    uint(211384331665408),
    uint(846636838289408),
    uint(1975852459884544),
    uint(3951704919769088),
    uint(7903409839538176),
    uint(15806819679076352),
    uint(31613639358152704),
    uint(63227278716305408),
    uint(54114388906344448),
    uint(216739030602088448),
    uint(505818229730443264),
    uint(1011636459460886528),
    uint(2023272918921773056),
    uint(4046545837843546112),
    uint(8093091675687092224),
    uint(16186183351374184448),
    uint(13853283560024178688),
    uint(144959613005987840),
    uint(362258295026614272),
    uint(724516590053228544),
    uint(1449033180106457088),
    uint(2898066360212914176),
    uint(5796132720425828352),
    uint(11592265440851656704),
    uint(4665729213955833856),
])

KNIGHT_ATTACKS = array([
    uint(132096),
    uint(329728),
    uint(659712),
    uint(1319424),
    uint(2638848),
    uint(5277696),
    uint(10489856),
    uint(4202496),
    uint(33816580),
    uint(84410376),
    uint(168886289),
    uint(337772578),
    uint(675545156),
    uint(1351090312),
    uint(2685403152),
    uint(1075839008),
    uint(8657044482),
    uint(21609056261),
    uint(43234889994),
    uint(86469779988),
    uint(172939559976),
    uint(345879119952),
    uint(687463207072),
    uint(275414786112),
    uint(2216203387392),
    uint(5531918402816),
    uint(11068131838464),
    uint(22136263676928),
    uint(44272527353856),
    uint(88545054707712),
    uint(175990581010432),
    uint(70506185244672),
    uint(567348067172352),
    uint(1416171111120896),
    uint(2833441750646784),
    uint(5666883501293568),
    uint(11333767002587136),
    uint(22667534005174272),
    uint(45053588738670592),
    uint(18049583422636032),
    uint(145241105196122112),
    uint(362539804446949376),
    uint(725361088165576704),
    uint(1450722176331153408),
    uint(2901444352662306816),
    uint(5802888705324613632),
    uint(11533718717099671552),
    uint(4620693356194824192),
    uint(288234782788157440),
    uint(576469569871282176),
    uint(1224997833292120064),
    uint(2449995666584240128),
    uint(4899991333168480256),
    uint(9799982666336960512),
    uint(1152939783987658752),
    uint(2305878468463689728),
    uint(1128098930098176),
    uint(2257297371824128),
    uint(4796069720358912),
    uint(9592139440717824),
    uint(19184278881435648),
    uint(38368557762871296),
    uint(4679521487814656),
    uint(9077567998918656),
])


ROOK_OCCUPANCY = array([
    uint(282578800148862),
    uint(565157600297596),
    uint(1130315200595066),
    uint(2260630401190006),
    uint(4521260802379886),
    uint(9042521604759646),
    uint(18085043209519166),
    uint(36170086419038334),
    uint(282578800180736),
    uint(565157600328704),
    uint(1130315200625152),
    uint(2260630401218048),
    uint(4521260802403840),
    uint(9042521604775424),
    uint(18085043209518592),
    uint(36170086419037696),
    uint(282578808340736),
    uint(565157608292864),
    uint(1130315208328192),
    uint(2260630408398848),
    uint(4521260808540160),
    uint(9042521608822784),
    uint(18085043209388032),
    uint(36170086418907136),
    uint(282580897300736),
    uint(565159647117824),
    uint(1130317180306432),
    uint(2260632246683648),
    uint(4521262379438080),
    uint(9042522644946944),
    uint(18085043175964672),
    uint(36170086385483776),
    uint(283115671060736),
    uint(565681586307584),
    uint(1130822006735872),
    uint(2261102847592448),
    uint(4521664529305600),
    uint(9042787892731904),
    uint(18085034619584512),
    uint(36170077829103616),
    uint(420017753620736),
    uint(699298018886144),
    uint(1260057572672512),
    uint(2381576680245248),
    uint(4624614895390720),
    uint(9110691325681664),
    uint(18082844186263552),
    uint(36167887395782656),
    uint(35466950888980736),
    uint(34905104758997504),
    uint(34344362452452352),
    uint(33222877839362048),
    uint(30979908613181440),
    uint(26493970160820224),
    uint(17522093256097792),
    uint(35607136465616896),
    uint(9079539427579068672),
    uint(8935706818303361536),
    uint(8792156787827803136),
    uint(8505056726876686336),
    uint(7930856604974452736),
    uint(6782456361169985536),
    uint(4485655873561051136),
    uint(9115426935197958144),
])

BISHOP_OCCUPANCY = array([
    uint(18049651735527936),
    uint(70506452091904),
    uint(275415828992),
    uint(1075975168),
    uint(38021120),
    uint(8657588224),
    uint(2216338399232),
    uint(567382630219776),
    uint(9024825867763712),
    uint(18049651735527424),
    uint(70506452221952),
    uint(275449643008),
    uint(9733406720),
    uint(2216342585344),
    uint(567382630203392),
    uint(1134765260406784),
    uint(4512412933816832),
    uint(9024825867633664),
    uint(18049651768822272),
    uint(70515108615168),
    uint(2491752130560),
    uint(567383701868544),
    uint(1134765256220672),
    uint(2269530512441344),
    uint(2256206450263040),
    uint(4512412900526080),
    uint(9024834391117824),
    uint(18051867805491712),
    uint(637888545440768),
    uint(1135039602493440),
    uint(2269529440784384),
    uint(4539058881568768),
    uint(1128098963916800),
    uint(2256197927833600),
    uint(4514594912477184),
    uint(9592139778506752),
    uint(19184279556981248),
    uint(2339762086609920),
    uint(4538784537380864),
    uint(9077569074761728),
    uint(562958610993152),
    uint(1125917221986304),
    uint(2814792987328512),
    uint(5629586008178688),
    uint(11259172008099840),
    uint(22518341868716544),
    uint(9007336962655232),
    uint(18014673925310464),
    uint(2216338399232),
    uint(4432676798464),
    uint(11064376819712),
    uint(22137335185408),
    uint(44272556441600),
    uint(87995357200384),
    uint(35253226045952),
    uint(70506452091904),
    uint(567382630219776),
    uint(1134765260406784),
    uint(2832480465846272),
    uint(5667157807464448),
    uint(11333774449049600),
    uint(22526811443298304),
    uint(9024825867763712),
    uint(18049651735527936),
])

ROOK_OCCUPANCY_BITS = array([
    12,11,11,11,11,11,11,12,
    11,10,10,10,10,10,10,11,
    11,10,10,10,10,10,10,11,
    11,10,10,10,10,10,10,11,
    11,10,10,10,10,10,10,11,
    11,10,10,10,10,10,10,11,
    11,10,10,10,10,10,10,11,
    12,11,11,11,11,11,11,12
])

BISHOP_OCCUPANCY_BITS = array([
    6,5,5,5,5,5,5,6,
    5,5,5,5,5,5,5,5,
    5,5,7,7,7,7,5,5,
    5,5,7,9,9,7,5,5,
    5,5,7,9,9,7,5,5,
    5,5,7,7,7,7,5,5,
    5,5,5,5,5,5,5,5,
    6,5,5,5,5,5,5,6
])


ROOK_MAGIC_NUMBERS = array([
    uint(36029381405327360),
    uint(1170971088562163712),
    uint(612524735842488320),
    uint(72075186291671072),
    uint(144117387368072224),
    uint(144132784624501248),
    uint(144115743334859264),
    uint(108087490574033024),
    uint(36169536658997280),
    uint(2305984021588353028),
    uint(581105158147022852),
    uint(4611826790276530306),
    uint(9295570402741059712),
    uint(144255942752469504),
    uint(9548757145382686788),
    uint(1297599644532080772),
    uint(36833643725440),
    uint(9876396457261547520),
    uint(141287512612864),
    uint(2252351717511168),
    uint(73184043768217728),
    uint(9517232462330070144),
    uint(1139094181642801),
    uint(865256277972911121),
    uint(18014675534880896),
    uint(87962003972104),
    uint(17611515494784),
    uint(11003710410784),
    uint(8798248895488),
    uint(289356295386038400),
    uint(577588868413919361),
    uint(1173258630019957761),
    uint(9901234168853955632),
    uint(76704165643952384),
    uint(333829460925091968),
    uint(3386637564252160),
    uint(7278945646592133120),
    uint(1127000496407040),
    uint(37718200963564552),
    uint(5207288151277824),
    uint(141012368392192),
    uint(2319354083511123968),
    uint(35189757771792),
    uint(325402665448177696),
    uint(9223935004525592592),
    uint(576465150383521920),
    uint(1173470346280697858),
    uint(563229671686148),
    uint(564051616735744),
    uint(18014684141593856),
    uint(439815466125440),
    uint(9895873094400),
    uint(8798240768128),
    uint(648522746535477376),
    uint(1175580248822055040),
    uint(1157706581899608320),
    uint(2378279936910696513),
    uint(13835075793539580162),
    uint(598134460924161),
    uint(4652218449501683745),
    uint(562985665840130),
    uint(79375950479380482),
    uint(576478417640358020),
    uint(45599496524071938)
])


BISHOP_MAGIC_NUMBERS = array([
    uint(1225647816496513056),
    uint(9027267506275584),
    uint(1768093866612753408),
    uint(9226821205377434624),
    uint(565217712996384),
    uint(1157711119863775297),
    uint(2305984314455656449),
    uint(576480577939833876),
    uint(1207070271572804672),
    uint(1251312969846914),
    uint(9306597566523520),
    uint(2476065558528),
    uint(3171101675184324736),
    uint(576497242481889536),
    uint(3747012761400385602),
    uint(2341896013780370432),
    uint(2256472872387616),
    uint(1161930975966429312),
    uint(1143526455509008),
    uint(1155179918739376130),
    uint(577305196833542162),
    uint(9290909768221185),
    uint(2459809976173072384),
    uint(4647855845597254144),
    uint(6919852433217749506),
    uint(9297480794558720),
    uint(4612830635835785472),
    uint(9385642500548592128),
    uint(2305988145025392672),
    uint(2260733379348768),
    uint(145241672165393408),
    uint(2882866917968972291),
    uint(4040300628981854464),
    uint(9516670680574464001),
    uint(1162071916694733824),
    uint(35223028893952),
    uint(9227895429843652612),
    uint(9223530924875514112),
    uint(155392333385336834),
    uint(4648278048901186049),
    uint(146369195804729605),
    uint(1153066708904216576),
    uint(720593824761516032),
    uint(36170917520941088),
    uint(9223763497521778720),
    uint(40567583182849160),
    uint(2254033338245632),
    uint(288555833749672192),
    uint(4692822348964999234),
    uint(74769014718732),
    uint(9281963370842488896),
    uint(69265264656),
    uint(720861891251535872),
    uint(360323176305033792),
    uint(9016172114378788),
    uint(1587817937966792712),
    uint(281784281532416),
    uint(2252366757892353),
    uint(38298258284744732),
    uint(4629718056369686600),
    uint(1153079834351553536),
    uint(18014742648521985),
    uint(288235397036114048),
    uint(4521201074455568),
])

with open('rookAttacks.dat','rb') as f:
    ROOK_ATTACKS = pickle.load(f)

with open('bishopAttacks.dat','rb') as f:
    BISHOP_ATTACKS = pickle.load(f)